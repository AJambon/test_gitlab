<div class="container-fluid">
  <form>
    <fieldset>
      <legend>
        <h5 class="section-title">
          Présentation de la zone humide et de ses milieux
        </h5>
      </legend>
      <div class="form-row">
        <div class="form-group col-md-6">
          <small class="required">Typologie SDAGE</small>
          <select class="form-control" [formControl]="form.controls.sdage">
            <option *ngFor="let sd of sdage" [ngValue]="sd.id_nomenclature">
              {{ sd.mnemonique }}
            </option>
          </select>
          <small
            *ngIf="
              (form.controls.sdage.touched || submitted) &&
              form.controls.sdage.errors?.required
            "
            class="error-msg"
            >Champ requis</small
          >
        </div>
        <div class="form-group col-md-6">
          <small>Typologie locale</small>
          <select class="form-control" [formControl]="form.controls.sage">
            <option></option>
            <option *ngFor="let sg of sage" [ngValue]="sg.id_nomenclature">
              {{ sg.mnemonique }}
            </option>
          </select>
        </div>
      </div>
      <div class="form-row">
        <div class="form-group col-md-6">
          <small>Corine Biotope</small>
          <input
            id="typeahead-basic"
            type="text"
            class="form-control"
            [formControl]="form.controls.corinBio"
            [resultFormatter]="formatter"
            [inputFormatter]="formatter"
            [ngbTypeahead]="search"
          />
        </div>
        <div class="form-group d-flex align-items-end col-md-6">
          <button mat-raised-button color="primary" (click)="onAddCorinBio()">
            <mat-icon>add_box</mat-icon>
            Ajouter
          </button>
        </div>
      </div>
      <div
        *ngIf="listCorinBio && listCorinBio.length > 0"
        class="table-responsive"
      >
        <table class="table">
          <thead class="thead-inverse table-header">
            <tr>
              <th *ngFor="let col of corinTableCol">{{ col.label }}</th>
              <th></th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let corin of listCorinBio">
              <td *ngFor="let col of corinTableCol">{{ corin[col.name] }}</td>
              <td>
                <div>
                  <button
                    mat-icon-button
                    placement="top"
                    ngbTooltip="Supprimer"
                    (click)="onDeleteCorin(corin.CB_code)"
                  >
                    <mat-icon class="delete-icon">close</mat-icon>
                  </button>
                </div>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
      <div class="form-row">
        <div class="form-group col-md-12">
          <small>Remarques</small>
          <angular2-multiselect [data]="itemList" 

          [settings]="settings" 
          (onSelect)="onItemSelect($event)"
          (onDeSelect)="OnItemDeSelect($event)" 
          (onSelectAll)="onSelectAll($event)" 
          (onDeSelectAll)="onDeSelectAll($event)">
</angular2-multiselect>
        </div>
      </div>
    </fieldset>
    <fieldset>
      <legend>
        <h5 class="section-title">Description de l'espace de fonctionnalité</h5>
      </legend>
      <div class="form-row">
        <div class="form-group col-md-12">
          <small>Occupation des sols (Nomenclature Corine Land Cover)</small>
          <ng-multiselect-dropdown
          [settings]="dropdownSettings"
          [data]="solOccupation"
        >
        </ng-multiselect-dropdown>
      </div>
      <div class="form-group col-md-12">
        <small>Remarques</small>
        <textarea class="form-control" rows="3"></textarea>
      </div>
      </div>

    </fieldset>
    <fieldset>
      <legend>
        <h5 class="section-title">Usage ou processus naturels</h5>
      </legend>
      <div class="form-row">
        <div class="form-group col-md-6">
          <button
              mat-raised-button
              color="primary"
              (click)="onAddActivity($event, activityModal)"
          >
          <mat-icon>add_box</mat-icon>
              Créer
          </button>
      </div>
        <div class="form-group col-md-6">
          <small>Activités humaines</small>
          <select class="form-control form-control-sm">
            <option></option>
            <option>option 1</option>
            <option>option 2</option>
          </select>
        </div>
        <div class="form-group col-md-6">
          <small>Localisation</small>
          <select class="form-control form-control-sm">
            <option></option>
            <option>option 1</option>
            <option>option 2</option>
          </select>
        </div>
        <div class="form-group col-md-6">
          <small>Impacts</small>
          <select class="form-control form-control-sm">
            <option></option>
            <option>option 1</option>
            <option>option 2</option>
          </select>
        </div>
        <div class="form-group col-md-6">
          <small>Remarque</small>
          <input class="form-control form-control-sm" type="text" />
        </div>
      </div>
      <div class="form-row">
        <div class="form-group col-md-12">
          <small>Remarques globales</small>
          <textarea class="form-control" rows="3"></textarea>
        </div>
      </div>
    </fieldset>
  </form>
</div>

<!-- MODAL humain activity -->
<ng-template
 #activityModal
 let-c="close"
 let-d="dismiss"
>
  <div class="modal-header">
    <h6>{{modalTitle}}</h6>
    <button mat-icon-button class="closeModalBtn" (click)="c();">
        <mat-icon class="cancel-icon">cancel</mat-icon>
      </button>
  </div>
  <div class="modal-body">
    <form [formGroup]="activityForm">
        <div class="form-row">
            <div class="form-group col-md-6">
                <small class="required">Activités humaines</small>
                <select 
                class="form-control form-control-sm" 
                [formControl]="activityForm.controls.humainActivity">
                <option
                    *ngFor="let activity of formMetaData.ACTIV_HUM"
                    [ngValue]="activity.id_nomenclature"
                >
                    {{activity.mnemonique}}</option>
            </select>
                <small *ngIf="(activityForm.controls.humainActivity.touched || submitted) && activityForm.controls.humainActivity.errors?.required"
                class="error-msg"
                >Champ requis</small>
            </div>
            <div class="form-group col-md-6">
                <small>Localisation</small>
                <select 
                class="form-control form-control-sm" 
                [formControl]="activityForm.controls.localisation">
                <option
                    *ngFor="let localisation of formMetaData.LOCALISATION"
                    [ngValue]="localisation.id_nomenclature"
                >
                    {{localisation.mnemonique}}</option>
            </select>

                
            </div>
            <div class="form-group col-md-6">
                <small>Année de parution</small>
            
            </div>
            <div class="form-group col-md-6">
                <small>Editeur</small>
                <input
                    [formControl]="activityForm.controls.editor"
                    class="form-control "
                    type='text'
                />
            </div>
            <div class="form-group col-md-6">
                <small>Lieu</small>
                <input
                    [formControl]="activityForm.controls.editor_location"
                    class="form-control "
                    type='text'
                />
            </div>
        </div>
    </form>
  </div>
  <div class="modal-footer">
    <button
      type="button"
      mat-raised-button
      color="primary"
      class="uppercase"
      (click)="patchActivity?  onPatchBib() : onAddBib()"
      [disabled] ="postedBib"
    >
    <mat-spinner *ngIf="postedBib" [diameter]="20" ></mat-spinner>
    {{modalButtonLabel}} 
  </button>
</div>