<form>
    <fieldset>
        <legend>
            <h5 class="section-title">Identification</h5>
        </legend>
        <div class="form-row">
            <div class="form-group col-md-6">
                <small class="required">Nom Usuel</small>
                <input
                class="form-control form-control-sm"
                type='text'
                [formControl]="generalInfoForm.controls.main_name"
                />
            </div>
            <div class="form-group col-md-6">
                <small>Autre nom</small>
                <input
                    class="form-control form-control-sm"
                    type='text'
                    [formControl]="generalInfoForm.controls.secondary_name"
                />
            </div>
        </div>
        <div class="form-row">
            <div class="form-group col-md-6">
                <small style="display: block; margin-bottom: 8px;">Partie d'un grand ensemble ?</small>
                <mat-label ngClass="labelBeforeSlide">Non</mat-label>
                <mat-slide-toggle
                [formControl]="generalInfoForm.controls.is_id_site_space">oui</mat-slide-toggle>    
            </div>
            <div *ngIf="hasSiteSpace" class="form-group col-md-6">
                <small>Nom du grand ensemble</small>
                <select 
                    list="grandEnsemble"
                    name="grandEnsemble"
                    class="form-control form-control-sm" 
                    [formControl]="generalInfoForm.controls.id_site_space">      
                    <option [ngValue]=null></option>
                    <option *ngFor="let siteSpace of siteSpaceList" [ngValue]=siteSpace.id_site_space>{{siteSpace.name}}</option>
                </select>
            </div>
        </div>
    </fieldset>
    <fieldset>
        <legend>
            <h5 class="section-title">Principales références bibliographiques</h5>
        </legend>
        <!-- <div class="form-row">
            <div class="form-group col-md-6">
                <small>Référence</small>
                <input
                class="form-control form-control-sm"
                    type='text'
                />
            </div>
            <div class="form-group col-md-6">
                <small>Titre du docuemnt</small>
                <input
                    class="form-control form-control-sm"
                    type='text'
                />
            </div>
            <div class="form-group col-md-6">
                <small>Auteurs</small>
                <input
                class="form-control form-control-sm"
                    type='text'
                />
            </div>
            <div class="form-group col-md-6">
                <small>Année de parution</small>
                <input
                    class="form-control form-control-sm"
                    type='text'
                />
            </div>
            <div class="form-group col-md-6">
                <small>Editeur</small>
                <input
                class="form-control form-control-sm"
                    type='text'
                />
            </div>
            <div class="form-group col-md-6">
                <small>Lieu</small>
                <input
                class="form-control form-control-sm"
                    type='text'
                />
            </div>
            <div class="form-group col-md-6">
                <small>Url</small>
                <input
                    class="form-control form-control-sm"
                    type='text'
                />
            </div>
            <div class="form-group col-md-6">
                <small>Bassin Versant</small>
                <input
                    class="form-control form-control-sm"
                    type='text'
                    readonly
                />
            </div>
        </div> -->
        <div class="form-row">
            <div class="form-group col-md-6">
                <pnx-autocomplete
                apiEndPoint="{{appConfig.API_ENDPOINT}}/zones_humides/references/autocomplete"
                [searchAsParameter]="false"
                [parentFormControl]="generalInfoForm.controls.bibRef"
                queryParamSearch="search_title"
                keyValue="title"
                [formatter]="formatter"
                label="Références bibliographiques"
                placeholder="Tapez les premières lettres..."
                (onChange)="onSelectLib($event)"
                >
                </pnx-autocomplete>
            </div>  
            <div class="form-group d-flex align-items-end col-md-6">
                <button
                    mat-raised-button
                    color="primary"
                    [disabled]="posted"
                    (click)="onAddBib()"
                >
                    Ajouter
                </button>
            </div>
        </div>
      <div *ngIf="listBib && listBib.length > 0" class="card-body table-responsive">
        <table class="table">
            <thead class="thead-inverse table-header">
                <tr>
                    <th *ngFor="let col of cols">{{col}}</th>
                    <th></th>
                </tr>
            </thead>
            <tbody>
                <tr *ngFor="let bib of listBib">
                    <td *ngFor="let col of cols">{{bib[col]}}</td>
                    <td>
                        <div>
                            <button mat-icon-button class="mr-2"
                             >
                             <mat-icon class="edit-icon">edit</mat-icon>
                            </button>
                            <button mat-icon-button (click)="onDeleteBib(bib.id_reference)">
                                <mat-icon class="delete-icon" >close</mat-icon>
                              </button>
                            
                        </div>
                    </td>
                </tr>
            </tbody>
        </table>
    </div>
    </fieldset>
</form>
<div class="navigate-btn">
    <button
        mat-raised-button
        color="warn"
        [disabled]="posted"
        (click)="onPrevious()"
    >
    Précédent
    </button>
    <button
      type="submit"
      mat-raised-button
      color=primary
      class="ml-3"
      [disabled]="posted"
      (click)="onFormSubmit(generalInfoForm.value)"
    >
    <mat-icon *ngIf="!posted">save_outline</mat-icon>
    <mat-spinner *ngIf="posted" [diameter]="20" ></mat-spinner>
    Suivant
    </button>